{"version":3,"sources":["components/Uploader.js","components/Tips.js","pages/Home.js"],"names":["Dragger","Upload","Result","styled","div","H2","h2","Image","img","Component","observer","useStores","ImageStore","UserStore","refWidth","useRef","refHeight","store","useLocalStore","width","setWidth","this","height","setHeight","serverFile","attributes","url","widthStr","heightStr","props","name","showUploadList","multiple","beforeUpload","file","console","log","setFile","setFilename","currentUser","test","type","size","message","error","upload","then","catch","warning","spinning","isUploading","className","InboxOutlined","filename","src","ref","onChange","current","value","placeholder","target","href","furlStr","Home","children","Tips","Uploader"],"mappings":"ikBAOQA,EAAYC,IAAZD,QAEFE,EAASC,IAAOC,IAAV,KAKNC,EAAKF,IAAOG,GAAV,KAIFC,EAAQJ,IAAOK,IAAV,KAqHIC,EAlHGC,aAAS,WAAO,IAAD,EACKC,cAA1BC,EADqB,EACrBA,WAAYC,EADS,EACTA,UACdC,EAAWC,mBACXC,EAAYD,mBAEZE,EAAQC,aAAc,iBAAO,CAC/BC,MAAO,KACPC,SAF+B,SAEtBD,GACLE,KAAKF,MAAQA,GAEjB,eACI,OAAOF,EAAME,MAAN,aAAoBF,EAAME,OAAU,IAE/CG,OAAQ,KACRC,UAT+B,SASrBD,GACND,KAAKC,OAASA,GAElB,gBACI,OAAOL,EAAMK,OAAN,aAAqBL,EAAMK,QAAW,IAEjD,cAEI,OAAOV,EAAWY,WAAWC,WAAWC,IAAID,WAAWC,IAAM,gBAAkBT,EAAMU,SAAWV,EAAMW,eAexGC,EAAQ,CACVC,KAAM,OACNC,gBAAgB,EAChBC,UAAU,EACVC,aAAc,SAAAC,GAIV,OAHAC,QAAQC,IAAI,SAAUF,GACtBtB,EAAWyB,QAAQH,GACnBtB,EAAW0B,YAAYJ,EAAKJ,MACvBjB,EAAU0B,YAKV,wCAAwCC,KAAKN,EAAKO,MAInDP,EAAKQ,KAAO,SACZC,IAAQC,MAAM,iCACP,IAEXhC,EAAWiC,SACNC,MAAK,SAACtB,GACHW,QAAQC,IAAI,uCAAoBZ,MACjCuB,OAAM,SAAAH,GACLT,QAAQC,IAAI,gCAAiCQ,OAE9C,IAbHD,IAAQC,MAAM,0EACP,IANPD,IAAQK,QAAQ,iEACT,KAqBnB,OACI,oCACI,kBAAC,IAAD,CAAMC,SAAUrC,EAAWsC,aACvB,kBAAClD,EAAY6B,EACT,uBAAGsB,UAAU,wBACT,kBAACC,EAAA,EAAD,OAEJ,uBAAGD,UAAU,mBAAb,gEACA,uBAAGA,UAAU,mBAAb,2GAOJvC,EAAWY,WACP,kBAACtB,EAAD,KACI,kBAACG,EAAD,iCACA,4BACI,wDACA,4BAAI,2BAAIO,EAAWY,WAAWC,WAAWC,IAAID,WAAWC,MAExD,kDACA,4BAAKd,EAAWyC,UAEhB,wDACA,4BACI,kBAAC9C,EAAD,CAAO+C,IAAK1C,EAAWY,WAAWC,WAAWC,IAAID,WAAWC,OAEhE,wDACA,4BACI,2BAAO6B,IAAKzC,EAAU0C,SAxE1B,WACpBrB,QAAQC,IAAI,sBACZD,QAAQC,IAAI,aAActB,GAC1BG,EAAMG,SAASN,EAAS2C,QAAQC,QAqEyCC,YAAY,qDAC7D,2BAAOJ,IAAKvC,EAAWwC,SAnE1B,WACrBvC,EAAMM,UAAUP,EAAUyC,QAAQC,QAkEyCC,YAAY,sDAEnE,4BACI,uBAAGC,OAAO,SAASC,KAAM5C,EAAM6C,SAAW7C,EAAM6C,YAIhD,SChHjBC,EAZFrD,aAAS,YAAiB,IAAfsD,EAAc,EAAdA,SACbnD,EAAaF,cAAbE,UAEP,OACI,oCAEIA,EAAU0B,YAAc,KAAQ,4BAAKyB,OCJ3CD,EAAOrD,aAAS,WACEC,cAAbE,UAEP,OACI,oCACI,kBAACoD,EAAD,qEACA,kBAACC,EAAD,UAKGH","file":"static/js/9.3a15ceeb.chunk.js","sourcesContent":["import React, { useRef } from 'react'\r\nimport { useStores } from '../stores'\r\nimport { observer, useLocalStore } from 'mobx-react'\r\nimport { Upload, message, Spin } from 'antd'\r\nimport { InboxOutlined } from '@ant-design/icons'\r\nimport styled from 'styled-components'\r\n\r\nconst { Dragger } = Upload;\r\n\r\nconst Result = styled.div`\r\n    margin-top:30px;\r\n    border:1px  dashed #ccc;\r\n    padding:20px;\r\n`\r\nconst H2 = styled.h2`\r\n    margin:20px 0;\r\n    text-align:center;\r\n    `\r\nconst Image = styled.img`\r\n    max-width:400px;\r\n`\r\nconst Component = observer(() => {\r\n    const { ImageStore, UserStore } = useStores()\r\n    const refWidth = useRef()\r\n    const refHeight = useRef()\r\n\r\n    const store = useLocalStore(() => ({\r\n        width: null,\r\n        setWidth(width) {\r\n            this.width = width\r\n        },\r\n        get widthStr() {\r\n            return store.width ? `/w/${store.width}` : ''\r\n        },\r\n        height: null,\r\n        setHeight(height) {\r\n            this.height = height\r\n        },\r\n        get heightStr() {\r\n            return store.height ? `/h/${store.height}` : ''\r\n        },\r\n        get furlStr() {\r\n            //?imageView2/0/w/800/h/400)\r\n            return ImageStore.serverFile.attributes.url.attributes.url + '?imageView2/0' + store.widthStr + store.heightStr\r\n        }\r\n\r\n    }))\r\n\r\n    const bindWidthChange = () => {\r\n        console.log('bindWidthChange...')\r\n        console.log('refWidth: ', refWidth);\r\n        store.setWidth(refWidth.current.value)\r\n    }\r\n\r\n    const bindHeightChange = () => {\r\n        store.setHeight(refHeight.current.value)\r\n    }\r\n\r\n    const props = {\r\n        name: 'file',\r\n        showUploadList: false,\r\n        multiple: false,\r\n        beforeUpload: file => {\r\n            console.log('file: ', file);\r\n            ImageStore.setFile(file)\r\n            ImageStore.setFilename(file.name)\r\n            if (!UserStore.currentUser) {\r\n                message.warning('请先登陆再上传！！！');\r\n                return false\r\n            }\r\n            //  /(svg$)|(png$)|(jpg$)|(jpeg$)|(gif$)/ig.test()\r\n            if (!/(svg$)|(png$)|(jpg$)|(jpeg$)|(gif$)/ig.test(file.type)) {\r\n                message.error('只能上传png/svg/jpg/gif格式的图片');\r\n                return false\r\n            }\r\n            if (file.size > 1024 * 1024 * 2) {\r\n                message.error('图片最大 2 M');\r\n                return false\r\n            }\r\n            ImageStore.upload()\r\n                .then((serverFile) => {\r\n                    console.log('serverFile上传成功: ', serverFile)\r\n                }).catch(error => {\r\n                    console.log('error in Uploader component: ', error);\r\n                })\r\n            return false\r\n        }\r\n    }\r\n\r\n    return (\r\n        <>\r\n            <Spin spinning={ImageStore.isUploading}>\r\n                <Dragger {...props}>\r\n                    <p className=\"ant-upload-drag-icon\">\r\n                        <InboxOutlined />\r\n                    </p>\r\n                    <p className=\"ant-upload-text\">点击或者拖拽上传图片</p>\r\n                    <p className=\"ant-upload-hint\">\r\n                        仅支持.png/.gif/.jpg/.svg格式的图片，图片最大 2 M\r\n                </p>\r\n                </Dragger>\r\n            </Spin>\r\n\r\n            {\r\n                ImageStore.serverFile ?\r\n                    <Result>\r\n                        <H2>上传结果</H2>\r\n                        <dl>\r\n                            <dt>线上地址</dt>\r\n                            <dd><a>{ImageStore.serverFile.attributes.url.attributes.url}</a></dd>\r\n\r\n                            <dt>文件名</dt>\r\n                            <dd>{ImageStore.filename}</dd>\r\n\r\n                            <dt>图片预览</dt>\r\n                            <dd>\r\n                                <Image src={ImageStore.serverFile.attributes.url.attributes.url}></Image>\r\n                            </dd>\r\n                            <dt>更多尺寸</dt>\r\n                            <dd>\r\n                                <input ref={refWidth} onChange={bindWidthChange} placeholder=\"最大宽度（可选）\" ></input>\r\n                                <input ref={refHeight} onChange={bindHeightChange} placeholder=\"最大高度（可选）\"></input>\r\n                            </dd>\r\n                            <dd>\r\n                                <a target=\"_blank\" href={store.furlStr} >{store.furlStr}</a>\r\n\r\n                            </dd>\r\n                        </dl>\r\n                    </Result> : null\r\n            }\r\n\r\n        </>\r\n    );\r\n})\r\n\r\nexport default Component;\r\n","import React from 'react'\r\nimport {observer} from 'mobx-react'\r\nimport {useStores} from '../stores'\r\n\r\nconst Home = observer(({children}) => {\r\n    const {UserStore} = useStores()\r\n\r\n    return (\r\n        <>\r\n        {\r\n            UserStore.currentUser ? null :  <h2>{children}</h2>\r\n        }\r\n       </>\r\n    );\r\n})\r\n\r\nexport default Home;","import React from 'react'\r\nimport {observer} from 'mobx-react'\r\nimport {useStores} from '../stores'\r\nimport Uploader  from '../components/Uploader'\r\nimport Tips from '../components/Tips'\r\n\r\nconst Home = observer(() => {\r\n    const {UserStore} = useStores()\r\n\r\n    return (\r\n        <>\r\n            <Tips>请先登陆再上传！！！</Tips>\r\n            <Uploader />\r\n        </>\r\n    );\r\n})\r\n\r\nexport default Home;"],"sourceRoot":""}