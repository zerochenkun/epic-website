{"version":3,"sources":["components/logo.svg","components/Header.js","components/Footer.js","components/Loading.js","App.js","index.js","models/index.js","stores/user.js","stores/history.js","stores/image.js","stores/auth.js","stores/index.js"],"names":["Header","styled","header","Logo","img","StyledLink","NavLink","Login","div","StyledButton","Button","Component","observer","history","useHistory","useStores","UserStore","AuthStore","useEffect","pullUser","src","LogoUrl","to","activeClassName","exact","currentUser","attributes","username","type","onClick","logout","push","Footer","footer","Loading","Home","lazy","History","About","Register","App","fallback","path","component","ReactDOM","render","document","getElementById","AV","init","appId","appKey","serverURL","Auth","register","password","user","User","setUsername","setPassword","Promise","resolve","reject","signUp","then","loginedUser","error","login","logIn","logOut","getCurrentUser","current","Uploader","add","file","filename","item","Object","avFile","File","set","save","serverFile","find","page","limit","query","Query","include","skip","descending","equalTo","results","catch","err","window","winUploader","this","observable","action","newList","list","concat","isLoading","append","length","hasMore","message","finally","newFilename","newFile","isUploading","values","resetUser","HistoryStore","reset","ImageStore","context","createContext","stores","useContext"],"mappings":"8MAAe,MAA0B,iC,wpBCSzC,IAAMA,EAASC,IAAOC,OAAV,KAQNC,EAAOF,IAAOG,IAAV,KAIJC,EAAaJ,YAAOK,IAAPL,CAAH,KASVM,EAAQN,IAAOO,IAAV,KAILC,EAAeR,YAAOS,IAAPT,CAAH,KAiDHU,EA5CIC,aAAS,WAC1B,IAAMC,EAAUC,cADgB,EAECC,cAAzBC,EAFwB,EAExBA,UAAWC,EAFa,EAEbA,UAkBnB,OAJAC,qBAAU,WACRF,EAAUG,cAIV,kBAACnB,EAAD,KACE,kBAACG,EAAD,CAAMiB,IAAKC,IACX,6BACE,kBAAChB,EAAD,CAAYiB,GAAG,IAAIC,gBAAgB,SAASC,OAAK,GAAjD,gBACA,kBAACnB,EAAD,CAAYiB,GAAG,WAAWC,gBAAgB,UAA1C,4BACA,kBAAClB,EAAD,CAAYiB,GAAG,SAASC,gBAAgB,UAAxC,uBAEF,kBAAChB,EAAD,KAEIS,EAAUS,YAAc,oCACrBT,EAAUS,YAAYC,WAAWC,SADZ,IACsB,kBAAClB,EAAD,CAAcmB,KAAK,UAAUC,QA3B9D,WACnBZ,EAAUa,WA0B0C,iBACzC,oCACL,kBAACrB,EAAD,CAAcmB,KAAK,UAAUC,QAzBjB,WAClBhB,EAAQkB,KAAK,YAwBP,gBACA,kBAACtB,EAAD,CAAcmB,KAAK,UAAUC,QAtBd,WACrBhB,EAAQkB,KAAK,eAqBP,sB,sJCtEV,IAAMC,EAAS/B,IAAOgC,OAAV,KAcKtB,MARjB,WACI,OACE,kBAACqB,EAAD,KACA,uCCFSE,MARf,WACI,OACI,6CCMFC,EAAOC,gBAAK,kBAAM,8DAClBC,EAAUD,gBAAK,kBAAM,8DACrBE,EAAQF,gBAAK,kBAAM,iCACnB7B,EAAQ6B,gBAAK,kBAAM,+DACnBG,EAAWH,gBAAK,kBAAM,+DAwBbI,MArBf,WACE,OACE,oCACE,kBAAC,EAAD,MACA,8BACE,kBAAC,WAAD,CAAUC,SAAU,kBAAC,EAAD,OAClB,kBAAC,IAAD,KACE,kBAAC,IAAD,CAAOC,KAAK,IAAIlB,OAAK,EAACmB,UAAWR,IACjC,kBAAC,IAAD,CAAOO,KAAK,WAAWC,UAAWN,IAClC,kBAAC,IAAD,CAAOK,KAAK,SAASC,UAAWL,IAChC,kBAAC,IAAD,CAAOI,KAAK,SAASC,UAAWpC,IAChC,kBAAC,IAAD,CAAOmC,KAAK,YAAYC,UAAWJ,OAKzC,kBAAC,EAAD,Q,aC1BNK,IAASC,OACL,kBAAC,IAAD,KACE,kBAAC,EAAD,OAEJC,SAASC,eAAe,U,gCCX1B,yFAEAC,IAAGC,KAAK,CACNC,MAAO,oCACPC,OAAQ,2BACRC,UAAW,yCAGb,IAAMC,EAAO,CACXC,SADW,SACF3B,EAAU4B,GACjB,IAAIC,EAAO,IAAIC,OAGf,OAFAD,EAAKE,YAAY/B,GACjB6B,EAAKG,YAAYJ,GACV,IAAIK,SAAQ,SAACC,EAASC,GAC3BN,EAAKO,SAASC,MAAK,SAAAC,GAAW,OAAIJ,EAAQI,MAAc,SAAAC,GAAK,OAAIJ,EAAOI,UAI5EC,MAVW,SAULxC,EAAU4B,GACd,OAAO,IAAIK,SAAQ,SAACC,EAASC,GAC3BL,OAAKW,MAAMzC,EAAS4B,GAAUS,MAAK,SAAAC,GAAW,OAAIJ,EAAQI,MAAc,SAAAC,GAAK,OAAIJ,EAAOI,UAI5FpC,OAhBW,WAiBV,OAAO2B,OAAKY,UAGbC,eApBW,WAqBT,OAAOb,OAAKc,YAIVC,EAAW,CACfC,IADe,SACXC,EAAKC,GACP,IAAMC,EAAO,IAAI5B,IAAG6B,OAAO,SACrBC,EAAS,IAAI9B,IAAG+B,KAAKJ,EAASD,GAKpC,OAHAE,EAAKI,IAAI,WAAWL,GACpBC,EAAKI,IAAI,QAAQhC,IAAGS,KAAKc,WACzBK,EAAKI,IAAI,MAAMF,GACR,IAAIlB,SAAQ,SAACC,EAAQC,GAC1Bc,EAAKK,OAAOjB,MAAK,SAAAkB,GAAU,OAAIrB,EAAQqB,MAAY,SAAAhB,GAASJ,EAAOI,UAIvEiB,KAbe,YAac,IAAD,IAAtBC,YAAsB,MAAf,EAAe,MAAZC,aAAY,MAAJ,GAAI,EACtBC,EAAQ,IAAItC,IAAGuC,MAAM,SAMzB,OALAD,EAAME,QAAQ,SACdF,EAAMD,MAAMA,GACZC,EAAMG,KAAKJ,EAAMD,GACjBE,EAAMI,WAAW,aACjBJ,EAAMK,QAAQ,QAAQ3C,IAAGS,KAAKc,WACvB,IAAIX,SAAQ,SAACC,EAAQC,GAC1BwB,EAAMH,OACHnB,MAAM,SAAA4B,GAAO,OAAI/B,EAAQ+B,MACzBC,OAAO,SAAAC,GAAG,OAAIjC,EAAQiC,WAM/BC,OAAOC,YAAcxB,G,+JC9CN,M,4IARXyB,KAAKxE,YAAc4B,IAAKiB,mB,kCAIxB2B,KAAKxE,YAAc,S,8CARpByE,K,yEAAyB,Q,oCAEzBC,K,0GAKAA,K,kFC4BY,M,2LA9BXd,MAAQ,G,mDAEOe,GACXH,KAAKI,KAAOJ,KAAKI,KAAKC,OAAOF,K,6BAGjB,IAAD,OACXH,KAAKM,WAAY,EACjB/B,IAASW,KAAK,CAAEC,KAAMa,KAAKb,KAAMC,MAAOY,KAAKZ,QACxCrB,MAAK,SAACoC,GACH,EAAKI,OAAOJ,GACZ,EAAKhB,OACDgB,EAAQK,OAAS,EAAKpB,QACtB,EAAKqB,SAAU,MAEpBb,OAAM,WACLc,IAAQzC,MAAR,uDACD0C,SAAQ,WACP,EAAKL,WAAY,O,8BAKzBN,KAAKI,KAAO,GACZJ,KAAKM,WAAY,EACjBN,KAAKS,SAAU,EACfT,KAAKb,KAAO,M,uCA9Bfc,K,wEAAkB,M,uCAClBA,K,yEAAuB,K,qCACvBA,K,yEAAqB,K,kCACrBA,K,yEAAkB,K,kCAGlBC,K,mGAIAA,K,kGAgBAA,K,qECYU,M,uPAjCOU,GAClBZ,KAAKtB,SAAWkC,I,8BAGFC,GACdb,KAAKvB,KAAOoC,I,+BAGI,IAAD,OAGf,OAFAb,KAAKc,aAAc,EACnBd,KAAKf,WAAa,KACX,IAAItB,SAAQ,SAACC,EAASC,GAC3BU,IAASC,IAAI,EAAKC,KAAM,EAAKC,UAC1BX,MAAK,SAAAkB,GACJ,EAAKA,WAAaA,EAClBrB,EAAQqB,MAETW,OAAM,SAAA3B,GACLyC,IAAQzC,MAAM,4BACdJ,EAAOI,MACN0C,SAAQ,WACT,EAAKG,aAAc,U,8BAMzBd,KAAKf,WAAa,KAClBe,KAAKvB,KAAO,KACZuB,KAAKc,aAAc,M,uCAlCpBb,K,yEAAkB,Q,sCAClBA,K,wEAAsB,M,wCACtBA,K,yEAAwB,Q,yCACxBA,K,yEAAyB,K,uCAEzBC,K,2GAIAA,K,sGAIAA,K,oGAkBAA,K,qECwBY,M,wIAhDOxE,GAClBsE,KAAKe,OAAOrF,SAAWA,I,kCAGL4B,GAClB0C,KAAKe,OAAOzD,SAAWA,I,8BAGR,IAAD,OACd,OAAO,IAAIK,SAAQ,SAACC,EAASC,GAC3BT,IAAKc,MAAM,EAAK6C,OAAOrF,SAAU,EAAKqF,OAAOzD,UAC1CS,MAAK,SAACR,GACLxC,EAAUG,WACV0C,EAAQL,MAETqC,OAAM,SAAA3B,GACLlD,EAAUiG,YACVN,IAAQzC,MAAM,4BACdJ,EAAOI,W,iCAIK,IAAD,OACjB,OAAO,IAAIN,SAAQ,SAACC,EAASC,GAC3BT,IAAKC,SAAS,EAAK0D,OAAOrF,SAAU,EAAKqF,OAAOzD,UAC7CS,MAAK,SAAAR,GACJxC,EAAUG,WACV0C,EAAQL,MAETqC,OAAM,SAAA3B,GACLlD,EAAUiG,YACVN,IAAQzC,MAAM,4BACdJ,EAAOI,W,+BAQbb,IAAKvB,SACLd,EAAUiG,YACVC,EAAaC,QACbC,EAAWD,Y,yCAhDZjB,K,wEAAoB,CACnBvE,SAAU,GACV4B,SAAU,O,uCAGX4C,K,+GAIAA,K,yGAIAA,K,sGAcAA,K,uGAiBAA,K,sEC7CGkB,EAAUC,wBAAc,CAC1BrG,YACAD,YACAoG,aACAF,iBAGJnB,OAAOwB,OAAS,CACZtG,YACAD,YACAoG,aACAF,gBAIG,IAAMnG,EAAY,kBAAMyG,qBAAWH,M","file":"static/js/main.7d0d2601.chunk.js","sourcesContent":["export default __webpack_public_path__ + \"static/media/logo.2d27ead7.svg\";","import React, { useState, useEffect } from 'react';\r\nimport LogoUrl from './logo.svg';\r\nimport { NavLink, useHistory } from 'react-router-dom';\r\nimport styled from 'styled-components';\r\nimport { Button } from 'antd';\r\nimport { useStores } from '../stores';\r\nimport { observer } from 'mobx-react';\r\n\r\n\r\nconst Header = styled.header`\r\n  display: flex;\r\n  align-items: center;\r\n  padding: 10px 100px;\r\n  background-color: #02101f;\r\n  color: #fff;\r\n`;\r\n\r\nconst Logo = styled.img`\r\n  height: 30px;\r\n`;\r\n\r\nconst StyledLink = styled(NavLink)`\r\n  color: #fff;\r\n  margin-left: 30px;\r\n\r\n  &.active {\r\n    border-bottom: 1px solid #fff;\r\n  }\r\n`;\r\n\r\nconst Login = styled.div`\r\n  margin-left: auto;\r\n`;\r\n\r\nconst StyledButton = styled(Button)`\r\n  margin-left: 10px;\r\n`;\r\n\r\n\r\nconst  Component = observer(() => {\r\n  const history = useHistory();\r\n  const { UserStore, AuthStore } = useStores();\r\n\r\n  const handleLogout = () => {\r\n    AuthStore.logout();\r\n  };\r\n\r\n  const handleLogin = () => {\r\n    history.push('/login');\r\n  };\r\n\r\n  const handleRegister = () => {\r\n    history.push('/register');\r\n  }\r\n\r\n  useEffect(()=>{\r\n    UserStore.pullUser()\r\n  })\r\n\r\n  return (\r\n    <Header>\r\n      <Logo src={LogoUrl} />\r\n      <nav>\r\n        <StyledLink to=\"/\" activeClassName=\"active\" exact>首页</StyledLink>\r\n        <StyledLink to=\"/history\" activeClassName=\"active\">上传历史</StyledLink>\r\n        <StyledLink to=\"/about\" activeClassName=\"active\">关于我</StyledLink>\r\n      </nav>\r\n      <Login>\r\n        {\r\n          UserStore.currentUser ? <>\r\n            {UserStore.currentUser.attributes.username} <StyledButton type=\"primary\" onClick={handleLogout}>注销</StyledButton>\r\n          </> :<>\r\n          <StyledButton type=\"primary\" onClick={handleLogin}>登录</StyledButton>\r\n          <StyledButton type=\"primary\" onClick={handleRegister}>注册</StyledButton>\r\n          </>\r\n\r\n        }\r\n      </Login>\r\n\r\n    </Header>\r\n  );\r\n});\r\n\r\nexport default Component;","import React from 'react'\r\nimport styled from 'styled-components'\r\n\r\nconst Footer = styled.footer`\r\n  padding:10px 100px;\r\n  text-align:center;\r\n  font-size:12px;\r\n  color:#aaa;\r\n`\r\nfunction Component() {\r\n    return (\r\n      <Footer>\r\n      <p>footer</p>\r\n      </Footer>\r\n    );\r\n  }\r\n  \r\n  export default Component;","import React from 'react'\r\n\r\nfunction Loading() {\r\n    return (\r\n        <div>\r\n            loading....\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default Loading;","import React, { Suspense, lazy } from 'react'\r\nimport './app.css'\r\nimport {\r\n  Switch,\r\n  Route\r\n} from 'react-router-dom'\r\nimport Header from './components/Header'\r\nimport Footer from './components/Footer'\r\nimport Loading from './components/Loading'\r\n\r\nconst Home = lazy(() => import('./pages/Home'))\r\nconst History = lazy(() => import('./pages/History'))\r\nconst About = lazy(() => import('./pages/About'))\r\nconst Login = lazy(() => import('./pages/Login'))\r\nconst Register = lazy(() => import('./pages/Register'))\r\n\r\n\r\nfunction App() {\r\n  return (\r\n    <>\r\n      <Header />\r\n      <main>\r\n        <Suspense fallback={<Loading />}>\r\n          <Switch>\r\n            <Route path='/' exact component={Home}></Route>\r\n            <Route path='/history' component={History}></Route>\r\n            <Route path='/about' component={About}></Route>\r\n            <Route path='/login' component={Login}></Route>\r\n            <Route path='/register' component={Register}></Route>\r\n          </Switch>\r\n          \r\n        </Suspense>\r\n      </main>\r\n      <Footer />\r\n    </>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport App from './App';\r\nimport 'antd/dist/antd.css';\r\nimport { HashRouter as Router } from 'react-router-dom'\r\nimport Model from './models';\r\n\r\nReactDOM.render(\r\n    <Router>\r\n      <App />\r\n    </Router>,\r\n  document.getElementById('root')\r\n);","import AV, {Query, User} from 'leancloud-storage'\r\n\r\nAV.init({\r\n  appId: \"70yyuctbKtOOpDR0oX94Qdz9-gzGzoHsz\",\r\n  appKey: \"l3XilxD0H1hcp0HzelO9WzDo\",\r\n  serverURL: \"https://70yyuctb.lc-cn-n1-shared.com\"\r\n});\r\n\r\nconst Auth = {\r\n  register(username, password) {\r\n    let user = new User();\r\n    user.setUsername(username);\r\n    user.setPassword(password);\r\n    return new Promise((resolve, reject) => {\r\n      user.signUp().then(loginedUser => resolve(loginedUser), error => reject(error))\r\n    });\r\n  },\r\n\r\n  login(username, password) {\r\n    return new Promise((resolve, reject) => {\r\n      User.logIn(username,password).then(loginedUser => resolve(loginedUser), error => reject(error))\r\n    });\r\n  },\r\n\r\n  logout() {\r\n   return User.logOut()\r\n  },\r\n\r\n  getCurrentUser(){\r\n    return User.current();\r\n  }\r\n}\r\n\r\nconst Uploader = {\r\n  add(file,filename){\r\n    const item = new AV.Object('Image')\r\n    const avFile = new AV.File(filename,file)\r\n\r\n    item.set('filename',filename)\r\n    item.set('owner',AV.User.current())\r\n    item.set('url',avFile)\r\n    return new Promise((resolve,reject) =>{\r\n      item.save().then(serverFile => resolve(serverFile),error=> {reject(error)})\r\n    })\r\n  },\r\n\r\n  find({page = 0, limit = 10}){\r\n    let query = new AV.Query('Image')\r\n    query.include('owner')\r\n    query.limit(limit)\r\n    query.skip(limit*page)\r\n    query.descending('createdAt')\r\n    query.equalTo('owner',AV.User.current())\r\n    return new Promise((resolve,reject) => {\r\n      query.find()\r\n        .then( results => resolve(results))\r\n        .catch( err => resolve(err))\r\n    })\r\n\r\n  }\r\n}\r\n\r\nwindow.winUploader = Uploader\r\nexport {Auth,Uploader}","import { observable, action } from 'mobx'\r\nimport { Auth } from '../models'\r\n\r\nclass UserStore {\r\n  @observable currentUser = null\r\n\r\n  @action pullUser() {\r\n    \r\n    this.currentUser = Auth.getCurrentUser()\r\n  }\r\n\r\n  @action resetUser() {\r\n    this.currentUser = null\r\n  }\r\n}\r\n\r\nexport default new UserStore()","import { observable, action } from 'mobx'\r\nimport { Uploader } from '../models'\r\nimport { message } from 'antd'\r\n\r\nclass HistoryStore {\r\n    @observable list = []\r\n    @observable isLoading = false\r\n    @observable hasMore = true\r\n    @observable page = 0\r\n    limit = 10\r\n\r\n    @action append(newList) {\r\n        this.list = this.list.concat(newList)\r\n    }\r\n\r\n    @action find() {\r\n        this.isLoading = true\r\n        Uploader.find({ page: this.page, limit: this.limit })\r\n            .then((newList) => {\r\n                this.append(newList)\r\n                this.page++\r\n                if (newList.length < this.limit) {\r\n                    this.hasMore = false;\r\n                }\r\n            }).catch(() => {\r\n                message.error(`历史数据加载失败`)\r\n            }).finally(() =>{\r\n                this.isLoading = false\r\n            })\r\n    }\r\n\r\n    @action reset() {\r\n        this.list = []\r\n        this.isLoading = false\r\n        this.hasMore = true\r\n        this.page = 0\r\n    }\r\n}\r\n\r\nexport default new HistoryStore()","import { observable, action } from 'mobx'\r\nimport { Uploader } from '../models'\r\nimport {message} from 'antd'\r\n\r\nclass ImageStore {\r\n  @observable file = null\r\n  @observable filename = \"\"\r\n  @observable serverFile = null\r\n  @observable isUploading = false\r\n\r\n  @action setFilename(newFilename) {\r\n    this.filename = newFilename\r\n  }\r\n\r\n  @action setFile(newFile) {\r\n    this.file = newFile\r\n  }\r\n\r\n  @action upload() {\r\n    this.isUploading = true\r\n    this.serverFile = null;\r\n    return new Promise((resolve, reject) => {\r\n      Uploader.add(this.file, this.filename)\r\n        .then(serverFile => {\r\n          this.serverFile = serverFile\r\n          resolve(serverFile)\r\n        })\r\n        .catch(error => {\r\n          message.error('上传失败');\r\n          reject(error)\r\n        }).finally(() => {\r\n          this.isUploading = false\r\n        })\r\n    })\r\n\r\n  }\r\n  @action reset(){\r\n    this.serverFile = null\r\n    this.file = null\r\n    this.isUploading = false\r\n  }\r\n}\r\n\r\nexport default new ImageStore()","import { observable, action } from 'mobx';\r\nimport { Auth } from '../models'\r\nimport UserStore from './user'\r\nimport HistoryStore from './history'\r\nimport ImageStore from './image'\r\nimport { message } from 'antd'\r\nclass AuthStore {\r\n  @observable values = {\r\n    username: '',\r\n    password: ''\r\n  }\r\n\r\n  @action setUsername(username) {\r\n    this.values.username = username\r\n  }\r\n\r\n  @action setPassword(password) {\r\n    this.values.password = password\r\n  }\r\n\r\n  @action login() {\r\n    return new Promise((resolve, reject) => {\r\n      Auth.login(this.values.username, this.values.password)\r\n        .then((user) => {\r\n          UserStore.pullUser()\r\n          resolve(user)\r\n        })\r\n        .catch(error => {\r\n          UserStore.resetUser();\r\n          message.error('登录失败')\r\n          reject(error)\r\n        })\r\n    })\r\n  }\r\n  @action register() {\r\n    return new Promise((resolve, reject) => {\r\n      Auth.register(this.values.username, this.values.password)\r\n        .then(user => {\r\n          UserStore.pullUser()\r\n          resolve(user)\r\n        })\r\n        .catch(error => {\r\n          UserStore.resetUser()\r\n          message.error('注册失败')\r\n          reject(error)\r\n        })\r\n    })\r\n\r\n  }\r\n\r\n\r\n  @action logout() {\r\n    Auth.logout()\r\n    UserStore.resetUser()\r\n    HistoryStore.reset()\r\n    ImageStore.reset()\r\n  }\r\n\r\n}\r\n\r\nexport default new AuthStore()","import React, { useContext, createContext } from 'react'\r\nimport AuthStore from './auth'\r\nimport UserStore from './user'\r\nimport ImageStore from './image'\r\nimport HistoryStore from './history'\r\n\r\nconst context = createContext({\r\n    AuthStore,\r\n    UserStore,\r\n    ImageStore,\r\n    HistoryStore\r\n})\r\n\r\nwindow.stores = {\r\n    AuthStore,\r\n    UserStore,\r\n    ImageStore,\r\n    HistoryStore\r\n};\r\n\r\n\r\nexport const useStores = () => useContext(context)"],"sourceRoot":""}